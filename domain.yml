version: '3.1'

session_config:
  session_expiration_time: 60
  carry_over_slots_to_new_session: true

intents:
- affirm
- booking_table
- deny
- give_time
- goodbye
- greet
- inform_dishes
- inform_num_people
- name_entry
- work_hours
- inform_task
- inform_reason
- prices
- time_to_cancel
- available_dates
- delivery
- choice_meals

entities:
- num_people
- dishes
- pizza_size
- pizza_type
- name
- task
- reason

slots:
  name:
    type: text
    influence_conversation: true
    mappings:
      - type: from_entity
        entity: name
  dishes:
    type: list
    influence_conversation: true
    mappings:
      - type: from_entity
        entity: dishes
  num_people:
    type: text
    influence_conversation: true
    mappings:
      - type: from_entity
        entity: num_people
  outdoor_seating:
    type: bool
    influence_conversation: true
    mappings:
      - type: from_intent
        intent: affirm
        value: true
      - type: from_intent
        intent: deny
        value: false
  task: 
    type: categorical
    influence_conversation: false
    values:
      - hall_renting
      - cancellation_hall_renting
      - daily_catering
    mappings: 
      - type: from_entity
        entity: task
  reason: 
    type: categorical
    influence_conversation: false
    values:
      - wedding
      - baptism
      - birthday
      - fault_of_customer
      - our_fault
      - premium
      - basic
    mappings: 
      - type: from_entity
        entity: reason
  form_trigger_intent:
    type: categorical
    influence_conversation: false
    values:
      - prices
      - available_dates
      - time_to_cancel
      - delivery
      - choice_meals
    mappings:
      - type: from_trigger_intent
        value: prices
        intent: prices
      - type: from_trigger_intent
        value: available_dates
        intent: available_dates
      - type: from_trigger_intent
        value: time_to_cancel
        intent: time_to_cancel
      - type: from_trigger_intent
        value: delivery
        intent: delivery
      - type: from_trigger_intent
        value: choice_meals
        intent: choice_meals

forms:
  booking_table_form:
    required_slots:
    - dishes
    - num_people
    - outdoor_seating
  task_form:
    required_slots:
      - task
      - reason
      - form_trigger_intent
      
responses:
  # utter_default:
  # - text: Sorry, i do not understand
  utter_greet:
  - text: Hey! How are you?
  utter_greet_with_name:
  - text: Nice to meet you {name}
  utter_goodbye:
  - text: Bye
  utter_work_hours:
  - text: I'm work between 8-16.
  utter_booking_table:
  - text: OK. What kind of dishes do you like?
  utter_ask_num_people:
  - text: for how many people to book a table?
  utter_ask_outdoor_seating:
  - text: could there be a table outside?
  utter_ask_task:
    - condition:
        - type: slot
          name: reason
          value: prices
      text: about the cost what do you ask?
    - text: How can i help you?
      buttons:
        - title: rent hall
          payload: /inform_task{{"task":"hall_renting"}}
        - title: cancellation hall renting
          payload: /inform_task{{"task":"cancellation_hall_renting"}}
        - title: daily catering
          payload: /inform_task{{"task":"daily_catering"}}
  utter_ask_reason:
    - condition:
        - type: slot
          name: task
          value: hall_renting
      text: "We can organize:"
      buttons:
        - title: wedding
          payload: /inform_reason{{"reason":"wedding"}}
        - title: baptism
          payload: /inform_reason{{"reason":"baptism"}}
        - title: birthday
          payload: /inform_reason{{"reason":"birthday"}}
    - condition:
        - type: slot
          name: task
          value: cancellation_hall_renting
      text: "whose fault do you want to cancel your rental?"
      buttons:
        - title: fault_of_customer
          payload: /inform_reason{{"reason":"fault_of_customer"}}
        - title: our_fault
          payload: /inform_reason{{"reason":"our_fault"}}
    - condition:
        - type: slot
          name: task
          value: daily_catering
      text: "which type of catering do you choose?"
      buttons:
        - title: premium
          payload: /inform_reason{{"reason":"premium"}}
        - title: basic
          payload: /inform_reason{{"reason":"basic"}}
    - text: How can i help you?
  utter_submit: 
    - condition:
        - type: slot
          name: form_trigger_intent
          value: "prices"
        - type: slot
          name: task
          value: "hall_renting"
        - type: slot
          name: reason
          value: "wedding"
      text: "price is 10000$"
    - condition:
        - type: slot
          name: form_trigger_intent
          value: "available_dates"
        - type: slot
          name: task
          value: "hall_renting"
        - type: slot
          name: reason
          value: "wedding"
      text: "We have free date after two years."


actions:
- action_show_time
- submit_booking_table_form
- utter_booking_table
- utter_goodbye
- utter_greet
- utter_work_hours
- validate_booking_table_form
- utter_submit
- utter_trigger_buttons
